# Ralph

```txt
РађРађРађРађРађРађРБђРБцРБХРАХРбЏРаЪРА┐Ра╗Рб╗Рб┐РбХРбдРБёРАђРађРађРађРађРађРађРађРађРађРађ
РађРађРађРбђРБаРАЙРАФРбіРаїРАљРбАРаіРб░РаЂРАјРаўРАёРббРаЎРАЏРАиРбцРАђРађРађРађРађРађРађРађ
РађРађРбаРбфРбІРАъРбаРаЃРАюРађРајРађРаЅРађРаЃРађРаЃРађРаЃРаЎРаўРаіРб╗РадРађРађРађРађРађРађ
РађРађРбЄРАЄРАюРађРаюРађРаЂРађРбђРаћРаЅРаЅРаЉРаёРађРађРА░РаіРаЅРаЉРАёРАЄРађРађРађРађРађРађ
РађРађРАИРаДРаёРађРађРађРађРађРаўРАђРаЙРађРађРБИРађРађРбДРађРаЏРађРаїРАЄРађРађРађРађРађРађ
РађРаўРАЄРађРађРађРађРађРађРађРађРаЎРањРањРаџРаЂРаѕРаЅРа▓РАЇРањРаѕРађРАЄРађРађРађРађРађРађ
РађРађРаѕРа▓РБєРађРађРађРађРађРађРађРађРБаРаќРаЅРА╣РацРаХРаЂРађРађРађРаѕРбдРађРађРађРађРађ
РађРађРађРађРаѕРБдРАђРађРађРађРађРаДРБ┤РаЂРађРаўРаЊРб▓РБёРБђРБђРБђРАцРаћРаЃРађРађРађРађРађ
РађРађРађРађРБюРађРаѕРаЊРадРбёРБђРБђРБИРађРађРађРађРаЂРбѕРбЄРБ╝РАЂРађРађРађРађРађРађРађРађ
РађРађРбаРањРаЏРа▓РБёРађРађРађРБаРаЈРађРаЅРа▓РБцРађРбИРаІРб╗РБцРАЏРБёРађРађРађРађРађРађРађ
РађРађРбАРађРађРађРађРаЅРб▓РаЙРаЂРађРађРађРађРаѕРб│РАЙРБцРаЪРаЂРа╣РБ┐РбєРађРађРађРађРађРађ
РађРбђРа╝РБєРађРађРађРађРађРађРађРађРађРађРађРађРБ╝РаЃРађРађРађРађРађРаѕРБДРађРађРађРађРађ
РађРАЈРађРаўРбдРАђРађРађРађРађРађРађРађРађРБаРаъРаЂРађРађРађРађРађРађРађРбИРБДРађРађРађРађ
Рб░РБёРађРађРађРаЅРа│РадРБцРБцРАцРа┤РаќРаІРаЂРађРађРађРађРађРађРађРађРађРађРб»РБєРађРађРађ
РбИРБЅРаЅРаЊРа▓РбдРБцРБёРБђРБђРађРађРађРађРађРађРађРађРађРађРбђРБђРБђРБђРБаРБ╝Рб╣РАёРађРађ
РаўРАЇРаЎРањРаХРбцРБёРБѕРБЅРАЅРаЅРаЅРаЏРаЏРаЏРаЏРаЏРаЏРб╗РаЅРаЅРаЅРбЎРБЈРБЂРБИРаЄРАЄРађРађ
РађРбБРађРађРађРађРађРађРаЅРаЅРЅаРаЎРаЏРаЏРаЏРаЏРаЏРаЏРаЏРањРањРањРаІРаЅРађРаИРаџРбЄРађРађ
РађРађРбДРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРбаРаЄРбцРБеРаЄРађ
РађРађРађРбДРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРБцРб╗РАђРБИРађРађРађ
РађРађРађРбИРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРб╣РаЏРаЅРаЂРађРађРађ
РађРађРађРбИРађРађРађРађРађРађРађРађРбаРбёРБђРБцРацРа┤РањРађРађРађРађРбИРађРађРађРађРађРађ
РађРађРађРбИРађРађРађРађРађРађРађРађРАЄРађРађРбИРађРађРађРађРађРађРађРаўРАєРађРађРађРађРађ
РађРађРађРАјРађРађРађРађРађРађРађРађРбиРађРађРбИРађРађРађРађРађРађРађРађРАЄРађРађРађРађРађ
РађРађРбђРАиРбцРБцРБђРБђРБђРБђРБаРацРаЙРБцРБђРАўРаЏРаХРаХРаХРаХРаќРањРаІРаЎРаЊРа▓РбцРБђРађ
РађРађРаўРаДРБђРАђРаѕРаЅРаЅРаЂРађРађРађРађРаѕРаЎРа│РБцРБёРБђРБђРБђРађРађРађРађРађРбђРБѕРАЄ
РађРађРађРађРађРаЅРаЏРа▓РацРацРбцРБцРБёРБђРБђРБђРБђРАИРаЄРађРађРађРаЅРаЅРаЅРаЅРаЅРаЅРаЂРађ
```

Iterative AI Development Loop Tool

Ralph implements the "Ralph Wiggum" technique for self-referential AI development loops using GitHub Copilot. It
continuously feeds prompts to AI, monitoring for completion signals, with each iteration building on previous work until
the task is done.

This is a C# port of the original [copilot-ralph](https://github.com/JanDeDobbeleer/copilot-ralph) by Jan De Dobbeleer.

> [!IMPORTANT]
> While Ralph works, it's highly experimental. Feel free to use it or as inspiration on how to integrate with AI
> development loops.

## Features

Рюе **Iterative AI Loops** - Run multiple AI iterations until task completion
РџЎ№ИЈ **Flexible Configuration** - Configure loops via command-line flags
­Ъцќ **GitHub Copilot Integration** - Powered by GitHub Copilot SDK
­ЪЊА **Real-time Event Streaming** - Watch iteration progress and tool execution
­ЪЏа№ИЈ **Tool Execution** - AI can read files, run commands, and make changes
РЈ▒№ИЈ **Timeout Controls** - Prevent runaway loops with safety limits

## Quick Start

### Prerequisites

- .NET 10.0 or later
- GitHub Copilot access
- Git

### Installation

Ralph is distributed as a .NET tool. You can install it globally from a local build:

```powershell
# Clone and build
git clone https://github.com/mattkotsenas/copilot-ralph.git
cd copilot-ralph/src

# Build and pack in Release mode
dotnet pack Ralph.Cli -c Release

# Install as a global tool from the local package
dotnet tool install --global Ralph.Cli `
  --add-source ..\artifacts\package\release
```

After installation, the `ralph` command will be available globally.

### Upgrading

After making changes to the code, rebuild and reinstall:

```powershell
# Rebuild
cd src
dotnet pack Ralph.Cli -c Release

# Update the tool
dotnet tool update --global Ralph.Cli `
  --add-source ..\artifacts\package\release
```

### Uninstalling

```powershell
dotnet tool uninstall --global Ralph.Cli
```

### Running from Source

You can also run directly from source without installing:

```powershell
cd src
dotnet run --project Ralph.Cli -- run "Your task here"
```

### Usage

```bash
# Run an AI development loop
ralph run "Add unit tests for the parser module"

# Use a Markdown file as the prompt
ralph run task_description.md

# With options
ralph run --max-iterations 5 --timeout 10m "Refactor authentication"

# Custom model and settings
ralph run \
  --model gpt-4-turbo \
  --promise "Task complete!" \
  --streaming=true \
  "Implement user authentication"
```

## How It Works

1. **Initialize** - Ralph parses your prompt and configuration (max iterations, timeout)
2. **Setup** - Create SDK client and loop engine with system prompt
3. **Listen** - Start event listener to display progress in real-time
4. **Loop** - For each iteration:
   - Send prompt to Copilot AI
   - Stream AI response to stdout
   - Execute any tools the AI invokes (read files, run commands, etc.)
5. **Complete** - Loop exits when:
   - Max iterations reached РюЊ Complete
   - Timeout exceeded РюЌ Timeout
   - Error occurs РюЌ Failed
   - User cancels (Ctrl+C) РюЌ Cancelled
6. **Summary** - Display final status, iteration count, and duration

```text
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ   Config &   Рћѓ
Рћѓ   Prompt     Рћѓ
РћћРћђРћђРћђРћђРћђРћђРћгРћђРћђРћђРћђРћђРћђРћђРћў
       Рћѓ
       v
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ      РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ  SDK Client      РћѓРћђРћђРћђРћђРћђ>Рћѓ  Copilot AI     Рћѓ
Рћѓ  Loop Engine     Рћѓ      Рћѓ  (per iteration)Рћѓ
РћћРћђРћђРћђРћђРћђРћђРћгРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў      РћћРћђРћђРћђРћђРћђРћђРћђРћђРћгРћђРћђРћђРћђРћђРћђРћђРћђРћў
       Рћѓ                           Рћѓ
       v                           v
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ      РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ  Event Listener  Рћѓ<РћђРћђРћђРћђРћђРћѓ  Tools Execute Рћѓ
Рћѓ  (Display)       Рћѓ      Рћѓ  (file ops,etc)Рћѓ
РћћРћђРћђРћђРћђРћђРћђРћгРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў      РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
       Рћѓ                           Рћѓ
       РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
              Рћѓ
              v
         РюЊ Complete (or timeout/error)
```

## Commands

### `ralph run`

Run an AI development loop.

```bash
# Direct prompt
ralph run "Add comprehensive error handling"

# Using a Markdown file as prompt
ralph run task_description.md

# With flags
ralph run \
  --max-iterations 20 \
  --timeout 1h \
  --model gpt-4-turbo \
  --log-level debug \
  "Implement user authentication"

# Dry run (show what would happen)
ralph run --dry-run "Refactor database layer"

# With custom system message
ralph run \
  --system-prompt "You are an expert C# developer" \
  --system-prompt-mode replace \
  "Optimize the code"
```

Available flags:

- `--max-iterations, -m` - Maximum loop iterations (default: 10)
- `--timeout, -t` - Maximum loop runtime (default: 30m)
- `--promise` - Completion promise phrase (default: "I'm special!")
- `--model` - AI model to use (default: gpt-4)
- `--working-dir` - Working directory (default: current)
- `--log-level` - Log level: debug, info, warn, error (default: info)
- `--streaming` - Enable streaming responses (default: true)
- `--system-prompt` - Custom system message
- `--system-prompt-mode` - append or replace (default: append)
- `--dry-run` - Show configuration without running

### `ralph version`

Show version information.

```bash
ralph version
ralph version --short
```

## Configuration

Ralph is configured entirely through command-line flags with sensible defaults. All settings can be customized per run:

- **Command-line flags** - All configuration via CLI flags
- **Default values** - Sensible defaults for all options

Common flags:

- `--max-iterations 10` - Maximum iterations before stopping
- `--timeout 30m` - Maximum runtime
- `--model gpt-4` - AI model to use
- `--promise "I'm special!"` - Completion phrase
- `--log-level info` - Logging verbosity
- `--streaming true` - Enable streaming responses

Run `ralph run --help` for all available options.

## Development

### Building

```powershell
cd src

# Restore dependencies
dotnet restore

# Build
dotnet build

# Run tests
dotnet test

# Run the CLI directly
dotnet run --project Ralph.Cli -- version

# Build and pack for distribution
dotnet pack Ralph.Cli -c Release
# Output: artifacts/package/release/Ralph.Cli.{version}.nupkg
```

## Architecture

Ralph is organized into distinct layers:

```text
src/
РћюРћђРћђ Ralph.Cli/              # Main application
Рћѓ   РћюРћђРћђ Commands/           # CLI commands (ConsoleAppFramework)
Рћѓ   РћюРћђРћђ Core/               # Loop engine, events, config
Рћѓ   РћюРћђРћђ Sdk/                # Copilot SDK wrapper
Рћѓ   РћюРћђРћђ Styles/             # Console styles (Spectre.Console)
Рћѓ   РћћРћђРћђ Version/            # Version information
РћћРћђРћђ Ralph.Tests/            # MSTest v2 tests
```

### Technology Stack

- **CLI Framework**: [ConsoleAppFramework](https://github.com/Cysharp/ConsoleAppFramework)
- **Console Rendering**: [Spectre.Console](https://spectreconsole.net/)
- **Testing**: MSTest with Microsoft Testing Platform v2
- **Target Framework**: .NET 10.0

## Contributing

Contributions are welcome! Please:

1. Ensure tests pass with `dotnet test`
2. Follow existing code style
3. Submit a pull request with clear description

## License

MIT License - see [LICENSE](./LICENSE) for details

## Acknowledgments

- **Original Implementation**: [copilot-ralph](https://github.com/JanDeDobbeleer/copilot-ralph) by [Jan De Dobbeleer](https://github.com/JanDeDobbeleer)
- Inspired by the [Ralph Wiggum plugin](https://github.com/anthropics/claude-code/tree/main/plugins/ralph-wiggum) for Claude
- Built with [GitHub Copilot SDK](https://github.com/github/copilot-sdk)
- Console UI powered by [Spectre.Console](https://spectreconsole.net/)
